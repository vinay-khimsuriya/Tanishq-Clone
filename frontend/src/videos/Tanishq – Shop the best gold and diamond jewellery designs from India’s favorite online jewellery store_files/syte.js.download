!function(){"use strict";var e=window.syteDataLayer||[];document.addEventListener("DOMContentLoaded",(function(){var t=$("body");function a(e,t){new IntersectionObserver((function(a,r){a.forEach((function(a){a.intersectionRatio>0&&(t(e),r.disconnect())}))})).observe(e)}$(".image-search-button").length&&(e=window.syteDataLayer||[]).push({name:"fe_camera_button_impression",tag:"camera",placement:"search-bar"}),$(".show-similar-pdp").length?(e=window.syteDataLayer||[]).push({name:"fe_page_view",tag:"ecommerce",sku:$(".show-similar-pdp.n-0").data("sku")}):(e=window.syteDataLayer||[]).push({name:"fe_page_view",tag:"ecommerce"}),t.on("click",".image-search-button",(function(){e.push({name:"fe_camera_button_click",tag:"camera",placement:"search-bar"})})),$(".show-similar-plp").each((function(){a(document.querySelector(".pid-"+$(this).data("sku")),(function(t){(e=window.syteDataLayer||[]).push({name:"fe_discovery_button_impression",tag:"discovery_button",sku:t.attributes.getNamedItem("data-sku").value,placement:t.attributes.getNamedItem("data-placement").value,imageSrc:t.attributes.getNamedItem("data-image-src").value})}))})),$(".show-similar-pdp").each((function(){a(document.querySelector(".n-"+$(this).data("index")),(function(t){(e=window.syteDataLayer||[]).push({name:"fe_discovery_button_impression",tag:"discovery_button",sku:t.attributes.getNamedItem("data-sku").value,placement:t.attributes.getNamedItem("data-placement").value,imageSrc:t.attributes.getNamedItem("data-image-src").value})}))})),t.on("click",".show-similar-plp, .show-similar-pdp",(function(){(e=window.syteDataLayer||[]).push({name:"fe_discovery_button_click",tag:"discovery_button",sku:$(this).data("sku"),placement:$(this).data("placement"),imageSrc:$(this).data("image-src")})})),t.on("product:afterAddToCart",(function(t,a){var r=[];a.cart&&a.cart.items.length&&(a.cart.items.forEach((function(e){var t={sku:e.id,quantity:e.quantity,price:"sales"in e.price?parseFloat(e.price.sales.value):parseFloat(e.price.list.value)};r.push(t)})),(e=window.syteDataLayer||[]).push({name:"products_added_to_cart",tag:"ecommerce",products:r}))})),t.on("checkout:start",(function(){var t=$(".c-pay-online").length?$(".c-pay-online").data("orderdetails"):$("#shipping-product-details").data("orderdetails");if(t){var a=[];t.items.items.forEach((function(e){var t={sku:e.id,quantity:e.quantity,price:"sales"in e.price?parseFloat(e.price.sales.value):parseFloat(e.price.list.value)};a.push(t)})),(e=window.syteDataLayer||[]).push({name:"checkout_start",tag:"ecommerce",value:t.totals.totalPrice,currency:t.totals.currencyCode,products:a})}})),t.on("checkout:complete",(function(){var t=[],a=JSON.parse($('input[name="gtmPurchaseData"]').val()),r=JSON.parse($('input[name="gtmOrderConfirmDatalayer"]').val());a=a.ecommerce,r.Items.forEach((function(e){var a={sku:e.productSKU,quantity:e.quantity,price:e.ISPrice};t.push(a)})),(e=window.syteDataLayer||[]).push({name:"checkout_complete",tag:"ecommerce",id:a.order_id||a.transaction_id,value:a.value,currency:a.currency,products:t})})),setTimeout((function(){var e=window.top.location.href;-1!==e.search("checkout")?t.trigger("checkout:start"):-1!==e.search("order")&&t.trigger("checkout:complete")}),1e3)}))}();